import{defaults}from"./defaults.js";import{extendParams,hasProperty,normalizeActionName,normalizeModuleName}from"../commonFunctions/index.js";const modulesToBeInstalled={};class Popover{constructor(e=".popover",o={}){var t=this;t.extendedParams=extendParams(defaults,o),t.parentElement="object"==typeof e?e:document.querySelector(e),t.modules={},t.actions={},t.onActionCallbacks={},t.setBody(),t.setControlButtons(),t.instalAllModules(),t.setDelegation(),t.attachAction({delegationId:"popoverBodyCloseButton",eventType:"click",actionName:"closePopover",func:t.closePopover.bind(t)})}setControlButtons(){var e=this;const{parentElement:o,extendedParams:t}=e;e.popoverBodyCloseButton=o.querySelector(t.popoverBodyCloseButton.selectors),e.popoverBodyCloseButton.setAttribute("data-delegation-id","popoverBodyCloseButton")}setBody(){var e=this["extendedParams"];this.body=document.body.querySelector(e.body.selectors)}closePopover(){var e=this["extendedParams"];this.body.classList.add(e.body.hiddenClass)}openPopover(){var e=this["extendedParams"];this.body.classList.remove(e.body.hiddenClass)}setDelegation(){var e=this;e.parentElement.addEventListener("click",e.onClick.bind(e))}onClick(e){var o=this,t=e.target.dataset["delegationId"];if(hasProperty(o.actions,t)&&hasProperty(o.actions[t],"click"))for(const s of Object.values(o.actions[t].click))s(e)}attachAction({delegationId:e,eventType:o,actionName:t,func:s}){var a=this;return hasProperty(a,"actions")||(a.actions={}),hasProperty(a.actions,e)||(a.actions[e]={}),hasProperty(a.actions[e],o)||(a.actions[e][o]={}),a.actions[e][o][t]=s,a}onAction(e,o){e=normalizeActionName(e);return this.onActionCallbacks["on"+e]=o,this}instalAllModules(){let e={};for(const o of Object.values(modulesToBeInstalled))e={...e,...o};this.use(e)}use(e){var o=this,t=Object.keys(e);if(0!==t.length){o.modules={...o.modules,...e};for(const a of t){var s=normalizeModuleName(a);hasProperty(o.extendedParams,s)?o[s]=new e[a](o,o.extendedParams[s]):o[s]=new e[a](o)}return o}}}export{Popover};